{
  "name": "Phoenix + LiveView (Dockerized)",
  "dockerComposeFile": [
    "../docker-compose.yml"
  ],
  "service": "web",
  "workspaceFolder": "/app",
  "runServices": ["db", "web"],
  "shutdownAction": "none",
  "remoteUser": "root",
  "forwardPorts": [4000, 5432],
   // Mount the host repo read-only at /seed so we can copy it into the empty /app volume
   "mounts": [
    "source=${localWorkspaceFolder},target=/seed,type=bind,consistency=cached,readonly"
  ],

  // On first open (when /app is empty), seed /app from /seed; then set up deps/assets
  "postCreateCommand": "bash -lc 'if [ ! -f /app/mix.exs ]; then echo \"Seeding /app from /seed â€¦\"; (cd /seed && tar cf - . --exclude=.git --exclude=_build --exclude=deps --exclude=priv/static/assets) | (cd /app && tar xf -); fi; mix deps.get && mix assets.setup'"
}

